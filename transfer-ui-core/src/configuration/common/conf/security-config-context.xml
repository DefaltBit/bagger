<beans xmlns:sec="http://www.springframework.org/schema/security"
    xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
                        http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-2.0.xsd">

	<import resource="classpath:conf/common-core-datasource-context.xml" />

	<bean id="securityDataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
		<property name="driverClassName" value= "org.postgresql.Driver" />
		<property name="url" value="$ds{jbpm.connection.url}" />
		<property name="username" value="$ds{jbpm.connection.username}" />
		<property name="password" value="$ds{jbpm.connection.password}" />
	</bean>	

   <sec:authentication-provider>
   		<sec:jdbc-user-service data-source-ref="securityDataSource" authorities-by-username-query="select name_, role_ from jbpm_id_membership where name_=?" users-by-username-query="select name_, password_, true from jbpm_id_user where name_=?"/>
	</sec:authentication-provider>
	
</beans>