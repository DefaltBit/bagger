<div id="taskinstance">
    <ul id="localNav">
        <li><a href="#taskDetails" ><span> Details </span></a></li>
        #if ($canUpdateUser)    <li><a href="#reassignTask"><span> Reassign </span></a></li> #end
        #if ($formViewName)     <li><a href="#updateTask"  ><span> Update   </span></a></li> #end
        <li><a href="#localHelp"><span> Help     </span></a></li>
    </ul>
    
	<div id="taskDetails">
        <h1>Details for Task: $taskInstanceBean.id</h1>
        <form action="null">
            <fieldset>
                <legend>Name: $taskInstanceBean.taskBean.name</legend>
    	        <table id="dataTable">
    	            <thead><tr id="taskDetailsHeader">
                            <td>Name</td>
                            <td>Value</td>
                            <td>Description</td>
                    </tr></thead>
                    <tfoot><tr id="taskDetailsHeader">
                            <td>Name</td>
                            <td>Value</td>
                            <td>Description</td>
                    </tr></tfoot>
                    <tbody>
                        <tr id="taskAssignee" >
                            <td>User</td>
                            <td>#if ($taskInstanceBean.userBean) $taskInstanceBean.userBean.id #else UNASSIGNED #end</td>
                            <td>This persons this task is currently assigned to, if any.</td>
                        </tr>
                        <tr id="taskVisibility" >
                            <td>Groups</td>
                            <td>#foreach($groupBean in $taskInstanceBean.groupBeanList) $groupBean.id #end</td>
                            <td>The groups this task is available to, if any.</td>
                        </tr>
                        <tr id="taskStatus" >
                            <td>Status</td>
                            <td>#if ( $taskInstanceBean.ended ) Completed #else Incomplete #end</td>
                            <td>The current status of this task.</td>
                        </tr>
                        #if ( $taskInstanceBean.ended )
                        <tr id="taskCompletionDate" >
                            <td>Date</td>
                            <td>$taskInstanceBean.endDate</td>
                            <td>The time at which this task was marked as completed.</td>
                        </tr>
                        #end
                    </tbody>
                </table>
            </fieldset>
        </form>
    </div>

    #if ($canUpdateUser)
	<div id="reassignTask">
	    <h1>Reassign Task</h1>
	    <form method="post" action="${requestURI}?method=put">
	        <fieldset>
	            <legend>Reassign this task to another user</legend>
	            <label for="taskReassingee">User</label>
    		    <select id="taskReassignee" name="user">
        			<option value="null">none</option>
        			#foreach($userBean in $userBeanList)
        				<option value="$userBean.id">$userBean.id</option>					
        			#end				
        		</select>
        		<input class="button" type="submit" value="submit"/>
	        </fieldset>
    	</form>
	</div>
    #end

    #if ($formViewName)
    <div id="updateTask">
	    <h1>Update</h1>
    	#if ($errorList.size() > 0)
    	<fieldset>
		    <legend>Errors</legend>
		    #foreach($error in $errorList)
			<label for="error">$error</label>
			<input id="error" 
			    type="text"
			    readonly="readonly"
			    value="$error"/>
		    #end
		</fieldset>
    	#end
		<form method="post" action="${requestURI}?method=put" enctype="multipart/form-data">
			#parse( "${formViewName}.vm" )
			<fieldset>
			    <legend>Transition</legend>
    			<select id="transition" name="transition">	
    				<option value="null">Leave task as incomplete.</option>
    				#foreach ($transition in $taskInstanceBean.taskBean.leavingTransitionList)	
    					<option value="$transition">#springMessageText("transitions.${transition}" $transition)</option>
    				#end
    			</select>							
    			<input class="button" type="submit" value="submit"/>
			</fieldset>
		</form>
	</div>
    #end
    
    <div id="localHelp">
		<h2>Help</h2>
	#if ($instructionViewName)
		#include("${instructionViewName}.vm")
	#else
	    <p>No help is currently available for this task.</p>
	#end
	</div>
</div>