<div id="workflows">
    
    <ul id="localNav">
        <li><a href="#activeWorkflows">
            <span> Active  ( $processInstanceBeanList.size() )  </span>
        </a></li>
        <li><a href="#problemWorkflows">
            <span> Problem  ( $problemProcessInstanceBeanList.size() )  </span>
        </a></li>
        <li><a href="#newWorkflow">
            <span> Start New </span>
        </a></li>
    </ul>
    
	<div id="activeWorkflows">
		<h2>Active Workflows</h2>
        <fieldset>
            <legend>These workflows are currently active.</legend>
            #if( $processInstanceBeanList.size() > 10 )
		    <table>
		        <tbody><tr><td>
                    <form id="activeWorkflows_pager" class="pager">
                		<img src="${contextPath}/images/icons/first.png" class="first"/>
                		<img src="${contextPath}/images/icons/prev.png" class="prev"/>
                		<label for="activeWorkflows_pagedisplay">Showing page </label>
                		<input id="activeWorkflows_pagedisplay" type="text" class="pagedisplay"/>
                		<img src="${contextPath}/images/icons/next.png" class="next"/>
                		<img src="${contextPath}/images/icons/last.png" class="last"/>
                		<label for="activeWorkflows_pagesize">Results per page: </label>
                		<select id="activeWorkflows_pagesize" class="pagesize">
                			<option selected="selected"  value="10">10</option>
                			<option value="20">20</option>
                			<option value="30">30</option>
                			<option  value="40">40</option>
                		</select>
                    </form>
                </td></tr></tbody>
            </table>
            #end
	        <table id="activeWorkflows_table" class="tablesorter pageable"  >
	            <thead><tr>
                        <th>Package</th>
                        <th>Workflow</th>
                        <th>Start date</th>
                        <th>Completion date</th>
                </tr></thead>
                <tfoot><tr>
                        <th>Package</th>
                        <th>Workflow</th>
                        <th>Start date</th>
                        <th>Completion date</th>
                </tr></tfoot>
                <tbody>
			        #foreach($processInstanceBean in $processInstanceBeanList)
			        <tr id="workflow_${processInstanceBean.id}" >
				        <td>
    				    #if($processInstanceBean.packageName) $processInstanceBean.packageName #else none #end
				        </td>
				        <td>
                            <a href="${contextPath}/processinstance/${processInstanceBean.id}.html">
				            ${processInstanceBean.processDefinitionBean.name}
                            (${processInstanceBean.id}) </a>
                        </td>
				        <td>
				            ${date.format('yyyy-MM-dd hh:mm', $processInstanceBean.startDate)}
				        </td>				        
				        <td>
				            #if($processInstanceBean.endDate)
				            	${date.format('yyyy-MM-dd hh:mm', $processInstanceBean.endDate)}
				            #else
				            	Incomplete
				            #end
				        </td>				        
				    </tr>					
			        #end
			    </tbody>
		    </table>
		</fieldset>
		
	</div>


	<div id="problemWorkflows">
		<h2>Problem Workflows</h2>
		<fieldset>
            <legend><div style="word-wrap:break-word;width:600px;">These workflows have either been suspended by a user or have tokens that have been suspended 
            because an error occurred.</div></legend>
            #if( $suspendedProcessInstanceBeanList.size() > 10)
            <table>
		        <tbody><tr><td>
                    <form id="problemWorkflows_pager" class="pager">
                		<img src="${contextPath}/images/icons/first.png" class="first"/>
                		<img src="${contextPath}/images/icons/prev.png" class="prev"/>
                		<label for="suspendedWorkflows_pagedisplay">Showing page </label>
                		<input id="suspendedWorkflows_pagedisplay" type="text" class="pagedisplay"/>
                		<img src="${contextPath}/images/icons/next.png" class="next"/>
                		<img src="${contextPath}/images/icons/last.png" class="last"/>
                		<label for="problemWorkflows_pagesize">Results per page: </label>
                		<select id="problemWorkflows_pagesize" class="pagesize">
                			<option selected="selected"  value="10">10</option>
                			<option value="20">20</option>
                			<option value="30">30</option>
                			<option  value="40">40</option>
                		</select>
                    </form>
                </td></tr></tbody>
            </table>
            #end
		    <table id="problemWorkflows_table" class="tablesorter pageable"  >
	            <thead>
	                <tr>
                        <th>Package</th>
                        <th>Workflow</th>
                    </tr>
                </thead>
                <tfoot><tr>
                        <th>Package</th>
                        <th>Workflow</th>
                </tr></tfoot>
                <tbody>
		    	#foreach($processInstanceBean in $problemProcessInstanceBeanList)
			        <tr id="workflow_${processInstanceBean.id}" >
				        <td>
    				    #if($processInstanceBean.packageName) $processInstanceBean.packageName #else none #end
				        </td>
				        <td>
                            <a href="${contextPath}/processinstance/${processInstanceBean.id}.html">
				            ${processInstanceBean.processDefinitionBean.name}
                            (${processInstanceBean.id}) </a>
                        </td>
				    </tr>					
    			#end	
                </tbody>
            </table>
        </fieldset>
	</div>


	<div id="newWorkflow">
		<h2>Workflows Types</h2>
		#if ($processDefinitionBeanList)					
			<ul>
				#foreach($processDefinitionBean in $processDefinitionBeanList)
				<li>					
					<form method="post" action="${contextPath}/processdefinition/${processDefinitionBean.id}.html">
	                    <fieldset title="Start a New Transfer Workflow">
				            <legend>
				            #if ($processDefinitionBean.id)
	        		            ${processDefinitionBean.name}
	        		            (${processDefinitionBean.id})
	        		        #else
	        		        	No process definition found.
	        		        #end
	        		        </legend>
				            <input type="hidden" name="referer" value="/index.html" />
				            #if ($processDefinitionBean.id)
		    					<input type="submit" class="button" value="start"/>
	        		        #end
	    					<label>Creating a new Transfer Workflow allows tracking a new transfer process.</label>
					    </fieldset>					
	    			</form>
				</li>					
				#end
			</ul>
		#else
			#login_required()
		#end
	</div>
</div>