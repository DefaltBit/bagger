#!/usr/bin/env perl

BEGIN {
	use File::Basename;
	use Cwd qw(abs_path);
	use lib abs_path(dirname($0) . "/../lib");
}

=head1 NAME

transport-add-user - add a storage system to the transport database

=head1 SYNOPSIS

transport-add-system --name ... --hostname ... [OPTIONS]

  Required values:
    --name          Short name for the system
    --hostname      Hostname used to connect to the system

  Options:
    --description   Documentation of the role of this named system
    --help

=head1 DESCRIPTION

transport-add-system registers a short name for a storage system with
the transport database.  All storage systems must be registered, and all
short names must be unique.  However, multiple short names can be associated
with a single system.  

=cut

use strict;
use warnings;
use Pod::Usage;
use Getopt::Long;

##----------------------------------------------------------------------

my %OPTIONS;

GetOptions \%OPTIONS, 'name=s', 'hostname=s', 'description=s', 'help';

# print help if appropriate
pod2usage({exitval => 0, verbose => 2}) if $OPTIONS{help};

# print help if appropriate
pod2usage({exitval => -1, verbose => 2}) 
    unless (defined($OPTIONS{name}) && defined($OPTIONS{hostname}));

##----------------------------------------------------------------------

use Transfer::Query qw(add_master);

add_master (
	'transport.systems', 
	short_name  => $OPTIONS{name},
	hostname    => $OPTIONS{hostname},
	description => $OPTIONS{description}
);

