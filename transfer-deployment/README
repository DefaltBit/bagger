# This is a scratch pad for now and will eventually become a formal README
# with release notes and detailed installation instructions

##################
# PREREQUISITES: #
##################

POSTGRESQL 8.2
---------------
You must have the PostgreSQL 8.2 database running
 before attempting to run this script.
 
=== To Deploy PostgreSQL 8.2 on Solaris 10 U4 ===
1.  Switch to the postgres role
    # su - postgres

2.  Create PostgreSQL DB cluster
    # /usr/postgres/8.2/bin/initdb -D /var/postgres/8.2/data

2.  Next the service will need to be DISABLED and ENABLED
    # /usr/sbin/svcadm disable postgresql:version_82
    # /usr/sbin/svcadm enable postgresql:version_82

TOMCAT 5.5.*
--------------
This can be obtained via the Sun Coolstack package here:
http://cooltools.sunsource.net/coolstack/

=== To Deploy Sun Coolstack Tomcat ====
1.  Download the CSKtomcat_1.2_x86.pkg.bz2 to your chosen directory.
2.  Decompress the archive in any directory:
    # bzip2 -d CSKtomcat_1.2_x86.pkg.bz2

3.  Install the package:
    (NOTE: If you only want the package installed in the current zone add a '-G' flag)
    # pkgadd -d CSKtomcat_1.2_x86.pkg

4.  Use svccfg to configure the appropriate amount of memory:
    # svccfg -s svc:/application/csk-tomcat:CSKtomcat setenv -m start JAVA_OPTS -Xmx64m
    # svccfg -s svc:/application/csk-tomcat:CSKtomcat setenv -m stop JAVA_OPTS -Xmx64m

5.  The installer may have already attempted to start Tomcat, which would have failed. Clear the SMF maintenance mode:
    # svcadm clear csk-tomcat

6.  Attempt to start Tomcat:
    # svcadm enable csk-tomcat

7.  Check the service is running:
    # svcs -a | grep csk-tomcat

8.  Check the default Tomcat site displays: http://YOURDOMAINNAME:8080/
    If its not running, tail the Tomcat log:
    # tail -f /var/svc/log/application-csk-tomcat:CSKtomcat.log

9.  Modify /opt/coolstack/tomcat/conf/tomcat-users.xml
    You will need a manager role and an admin role as shown in this example:

<?xml version='1.0' encoding='utf-8'?>
<tomcat-users>
  <role rolename="tomcat"/>
  <role rolename="manager"/>
  <role rolename="admin"/>
  <user username="admin" password="password" roles="admin,manager"/>
  <user username="tomcat" password="tomcat" roles="tomcat"/>
</tomcat-users>

